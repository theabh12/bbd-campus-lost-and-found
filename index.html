<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>BBD Lost & Found ‚Äî Home</title>
  <link rel="icon" href="https://bbdu.ac.in/wp-content/uploads/2018/10/favicon-300x300.png">
  <style>
    /* ---------- your original CSS (kept as-is) ---------- */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --primary-color: #007AFF;
      --secondary-color: #5856D6;
      --success-color: #34C759;
      --danger-color: #FF3B30;
      --warning-color: #FF9500;
      --text-primary: #1d1d1f;
      --text-secondary: #6e6e73;
      --glass-bg: rgba(255, 255, 255, 0.7);
      --glass-border: rgba(255, 255, 255, 0.3);
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.08);
      --shadow-md: 0 8px 32px rgba(0, 0, 0, 0.12);
      --shadow-lg: 0 16px 48px rgba(0, 0, 0, 0.16);
      --spacing-xs: 8px;
      --spacing-sm: 16px;
      --spacing-md: 24px;
      --spacing-lg: 32px;
      --spacing-xl: 48px;
      --spacing-xxl: 64px;
      --radius-sm: 12px;
      --radius-md: 16px;
      --radius-lg: 24px;
      --radius-xl: 32px;
      --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }
    body {
      font-family: var(--font-family);
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: var(--text-primary);
      overflow-x: hidden;
      line-height: 1.6;
    }
    .glass-card {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: var(--radius-lg);
      border: 1px solid var(--glass-border);
      box-shadow: var(--shadow-md);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .glass-card:hover { transform: translateY(-8px); box-shadow: var(--shadow-lg); }
    .glass-btn {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-md);
      padding: 10px 20px;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-sm);
      display: inline-flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
      border: none;
    }
    .glass-btn:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); background: rgba(255,255,255,0.85); }
    .glass-btn.primary { background: var(--primary-color); color: white; }
    .glass-btn.success { background: var(--success-color); color: white; }
    .glass-btn.small { padding: 6px 12px; font-size: 12px; }

    /* Header */
    .glass-header {
      position: sticky;
      top: 0;
      z-index: 1000;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--glass-border);
      box-shadow: var(--shadow-sm);
      animation: fadeInDown 0.6s ease;
    }
    .nav-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 16px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .nav-left { display:flex; align-items:center; gap:16px; }
    .logo { width:40px; height:40px; border-radius:8px; }
    .site-title { font-size:18px; font-weight:600; color:var(--text-primary); }
    .nav-right { display:flex; align-items:center; gap:16px; }
    .nav-link { color:var(--text-primary); text-decoration:none; font-size:14px; font-weight:500; padding:8px 16px; border-radius:var(--radius-sm); transition:all .3s ease; }
    .nav-link:hover { background: rgba(0,0,0,0.05); }
    .nav-link.active { background: rgba(0,122,255,0.1); color: var(--primary-color); }

    /* Hero Section */
    .hero { padding:64px 32px; display:flex; justify-content:center; align-items:center; animation:fadeIn 0.8s ease; }
    .hero-card { max-width:800px; padding:48px; text-align:center; display:flex; flex-direction:column; align-items:center; gap:32px; }
    .hero-icon { width:120px; height:120px; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); border-radius:var(--radius-xl); display:flex; align-items:center; justify-content:center; box-shadow:0 16px 48px rgba(0,122,255,0.3); animation:float 3s ease-in-out infinite; }
    .hero-icon svg { width:60px; height:60px; stroke:white; }
    .hero-title { font-size:56px; font-weight:700; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .hero-subtitle { font-size:24px; color:var(--text-secondary); max-width:600px; }
    .hero-actions { display:flex; gap:16px; margin-top:16px; }

    /* Filter Section */
    .filter-section { padding:0 32px 32px; max-width:1400px; margin:0 auto; }
    .filter-container { background:var(--glass-bg); backdrop-filter: blur(20px); border-radius:var(--radius-lg); padding:24px; display:flex; gap:16px; flex-wrap:wrap; align-items:center; border:1px solid var(--glass-border); }
    .filter-group { flex:1; min-width:200px; }
    .filter-label { display:block; margin-bottom:8px; font-size:14px; font-weight:500; color:var(--text-primary); }
    .filter-input, .filter-select { width:100%; padding:10px 16px; border-radius:var(--radius-sm); border:1px solid rgba(0,0,0,0.1); background: white; font-size:14px; font-family:var(--font-family); }
    .category-pills { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
    .category-pill { padding:6px 16px; border-radius:20px; background:white; border:2px solid var(--primary-color); color:var(--primary-color); font-size:12px; font-weight:500; cursor:pointer; transition:all .3s ease; }
    .category-pill.active { background:var(--primary-color); color:white; }

    /* Posts Section */
    .posts-section { padding:32px; animation:fadeIn 1s ease; }
    .container { max-width:1400px; margin:0 auto; }
    .section-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:32px; }
    .section-title { font-size:48px; font-weight:700; color:white; text-shadow:0 2px 8px rgba(0,0,0,0.2); }
    .posts-grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap:24px; }

    .post-card { overflow:hidden; cursor:pointer; position:relative; }
    .post-status { position:absolute; top:16px; right:16px; padding:6px 12px; border-radius:20px; font-size:12px; font-weight:600; z-index:10; }
    .post-status.lost { background: var(--danger-color); color: white; }
    .post-status.found { background: var(--success-color); color: white; }
    .post-image { width:100%; height:240px; overflow:hidden; border-radius:var(--radius-md); margin-bottom:16px; position:relative; }
    .post-image img { width:100%; height:100%; object-fit:cover; }
    .post-image-placeholder { width:100%; height:100%; background: linear-gradient(135deg, #E3F2FD, #BBDEFB); display:flex; align-items:center; justify-content:center; font-size:72px; }
    .post-content { padding:24px; }
    .post-category { display:inline-block; padding:4px 12px; border-radius:6px; background: rgba(0,122,255,0.1); color: var(--primary-color); font-size:12px; font-weight:600; margin-bottom:12px; }
    .post-title { font-size:24px; font-weight:600; margin-bottom:8px; color:var(--text-primary); }
    .post-description { font-size:16px; color:var(--text-secondary); margin-bottom:16px; line-height:1.5; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }
    .post-meta { display:flex; gap:16px; flex-wrap:wrap; margin-bottom:16px; }
    .meta-item { display:flex; align-items:center; gap:6px; font-size:14px; color:var(--text-secondary); }
    .post-actions { display:flex; gap:8px; padding-top:16px; border-top:1px solid rgba(0,0,0,0.1); }

    /* Modal (Add Item) - kept as original */
    .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.6); backdrop-filter: blur(10px); z-index:2000; align-items:center; justify-content:center; padding:20px; overflow-y:auto; }
    .modal.active { display:flex; }
    .modal-content { background:white; border-radius:var(--radius-lg); max-width:600px; width:100%; max-height:90vh; overflow-y:auto; position:relative; }
    .modal-header { padding:24px; border-bottom:1px solid rgba(0,0,0,0.1); display:flex; justify-content:space-between; align-items:center; }
    .modal-title { font-size:24px; font-weight:600; }
    .modal-close { width:32px; height:32px; border:none; background: rgba(0,0,0,0.05); border-radius:50%; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:20px; }
    .modal-body { padding:24px; }
    .form-group { margin-bottom:20px; }
    .form-label { display:block; margin-bottom:8px; font-size:14px; font-weight:500; color:var(--text-primary); }
    .form-input, .form-textarea, .form-select { width:100%; padding:12px 16px; border-radius:var(--radius-sm); border:1px solid rgba(0,0,0,0.1); font-size:14px; font-family:var(--font-family); }
    .form-textarea { resize:vertical; min-height:100px; }
    .image-upload { border:2px dashed var(--primary-color); border-radius:var(--radius-md); padding:32px; text-align:center; cursor:pointer; transition:all .3s ease; }
    .image-upload:hover { background: rgba(0,122,255,0.05); }
    .image-upload input { display:none; }
    .image-preview { margin-top:16px; border-radius:var(--radius-md); overflow:hidden; display:none; }
    .image-preview img { width:100%; max-height:300px; object-fit:cover; }
    .modal-footer { padding:24px; border-top:1px solid rgba(0,0,0,0.1); display:flex; gap:12px; justify-content:flex-end; }

    /* Detail Modal */
    .detail-modal .modal-content { max-width:900px; }
    .detail-image { width:100%; max-height:400px; object-fit:cover; border-radius:var(--radius-md); margin-bottom:24px; }
    .detail-info { display:grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap:16px; margin-bottom:24px; }
    .info-item { padding:16px; background: rgba(0,122,255,0.05); border-radius:var(--radius-sm); }
    .info-label { font-size:12px; color:var(--text-secondary); margin-bottom:4px; }
    .info-value { font-size:16px; font-weight:600; color:var(--text-primary); }
    .contact-section { padding:24px; background: rgba(0,122,255,0.05); border-radius:var(--radius-md); margin-top:24px; }

    /* Footer */
    .glass-footer { background: rgba(255,255,255,0.8); backdrop-filter: blur(20px); border-top:1px solid var(--glass-border); padding:32px; text-align:center; margin-top:64px; }

    /* Animations */
    @keyframes fadeIn { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }
    @keyframes fadeInDown { from { opacity:0; transform:translateY(-20px); } to { opacity:1; transform:translateY(0); } }
    @keyframes float { 0%,100%{ transform:translateY(0);} 50%{ transform:translateY(-10px);} }

    /* Responsive */
    @media (max-width: 768px) {
      .nav-container { flex-direction: column; gap: 16px; }
      .nav-right { flex-wrap: wrap; justify-content: center; }
      .hero-title { font-size: 32px; }
      .section-title { font-size: 32px; }
      .posts-grid { grid-template-columns: 1fr; }
      .filter-container { flex-direction: column; }
      .hero-actions { flex-direction: column; width: 100%; }
    }

    /* ---------- ADDED: auth modals (styled to match glass UI) ---------- */
    .auth-modal .modal-content { background: rgba(255,255,255,0.94); border-radius:18px; padding:0; max-width:420px; }
    .auth-header { padding:20px 24px; border-bottom:1px solid rgba(0,0,0,0.06); display:flex; justify-content:space-between; align-items:center; }
    .auth-body { padding:20px 24px; }
    .auth-footer { padding:16px 24px; border-top:1px solid rgba(0,0,0,0.06); display:flex; justify-content:flex-end; gap:8px; }
    .auth-title { font-size:20px; font-weight:700; }
    .small-note { font-size:13px; color:var(--text-secondary); margin-top:6px; }
    .error-msg { color: var(--danger-color); font-size:13px; margin-top:8px; display:none; }
    .success-msg { color: var(--success-color); font-size:13px; margin-top:8px; display:none; }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="glass-header">
    <nav class="nav-container">
      <div class="nav-left">
        <img src="https://bbdu.ac.in/wp-content/uploads/2018/10/favicon-300x300.png" alt="BBD Logo" class="logo">
        <h1 class="site-title">BBD Lost & Found</h1>
      </div>
      <div class="nav-right" id="navRight">
        <a href="index.html" class="nav-link active">Home</a>
        <a href="contributions.html" class="nav-link">Contributions</a>

        <!-- These are the buttons we wire to auth -->
        <button id="loginBtn" class="glass-btn">Login</button>
        <button id="signupBtn" class="glass-btn primary">Signup</button>

        <!-- After login, we replace with user display and logout -->
        <!-- placeholder elements injected by JS -->
      </div>
    </nav>
  </header>

  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-card glass-card">
      <div class="hero-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
      </div>
      <h2 class="hero-title">Campus Lost & Found</h2>
      <p class="hero-subtitle">Find your items quickly with a clean, modern UI</p>
      <div class="hero-actions">
        <button class="glass-btn primary" id="addItemBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          Add Lost/Found Item
        </button>
        <a href="contributions.html" class="glass-btn">
          View Contributors
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14"></path>
            <path d="m12 5 7 7-7 7"></path>
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Filter Section -->
  <section class="filter-section">
    <div class="filter-container">
      <div class="filter-group">
        <label class="filter-label">Search</label>
        <input type="text" class="filter-input" id="searchInput" placeholder="Search items...">
      </div>
      <div class="filter-group">
        <label class="filter-label">Status</label>
        <select class="filter-select" id="statusFilter">
          <option value="">All Items</option>
          <option value="lost">Lost Items</option>
          <option value="found">Found Items</option>
        </select>
      </div>
      <div class="filter-group">
        <label class="filter-label">Category</label>
        <div class="category-pills">
          <span class="category-pill active" data-category="">All</span>
          <span class="category-pill" data-category="Electronics">Electronics</span>
          <span class="category-pill" data-category="Books">Books</span>
          <span class="category-pill" data-category="Accessories">Accessories</span>
          <span class="category-pill" data-category="Clothing">Clothing</span>
          <span class="category-pill" data-category="Documents">Documents</span>
          <span class="category-pill" data-category="Others">Others</span>
        </div>
      </div>
    </div>
  </section>

  <!-- Posts Grid -->
  <section class="posts-section">
    <div class="container">
      <div class="section-header">
        <h3 class="section-title">Recent Posts</h3>
      </div>
      <div class="posts-grid" id="postsGrid">
        <!-- Posts will be dynamically generated here -->
      </div>
    </div>
  </section>

  <!-- Add Item Modal (original) -->
  <div class="modal" id="addModal" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Add Lost/Found Item</h3>
        <button class="modal-close" onclick="closeAddModal()">√ó</button>
      </div>
      <div class="modal-body">
        <form id="addItemForm">
          <div class="form-group">
            <label class="form-label">Status *</label>
            <select class="form-select" id="itemStatus" required>
              <option value="">Select Status</option>
              <option value="lost">Lost</option>
              <option value="found">Found</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Category *</label>
            <select class="form-select" id="itemCategory" required>
              <option value="">Select Category</option>
              <option value="Electronics">Electronics</option>
              <option value="Books">Books</option>
              <option value="Accessories">Accessories</option>
              <option value="Clothing">Clothing</option>
              <option value="Documents">Documents</option>
              <option value="Others">Others</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Item Name *</label>
            <input type="text" class="form-input" id="itemName" placeholder="e.g., Blue Water Bottle" required>
          </div>
          <div class="form-group">
            <label class="form-label">Description *</label>
            <textarea class="form-textarea" id="itemDescription" placeholder="Describe the item in detail..." required></textarea>
          </div>
          <div class="form-group">
            <label class="form-label">Location *</label>
            <input type="text" class="form-input" id="itemLocation" placeholder="e.g., Library, Cafeteria" required>
          </div>
          <div class="form-group">
            <label class="form-label">Your Name *</label>
            <input type="text" class="form-input" id="userName" placeholder="Your full name" required>
          </div>
          <div class="form-group">
            <label class="form-label">Your Email *</label>
            <input type="email" class="form-input" id="userEmail" placeholder="your.email@example.com" required>
          </div>
          <div class="form-group">
            <label class="form-label">Your Phone *</label>
            <input type="tel" class="form-input" id="userPhone" placeholder="+91 XXXXXXXXXX" required>
          </div>
          <div class="form-group">
            <label class="form-label">Upload Image</label>
            <div class="image-upload" onclick="document.getElementById('itemImage').click()">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
              <p style="margin-top: 12px; color: var(--text-secondary);">Click to upload image</p>
              <input type="file" id="itemImage" accept="image/*">
            </div>
            <div class="image-preview" id="imagePreview">
              <img id="previewImg" src="" alt="Preview">
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="glass-btn" onclick="closeAddModal()">Cancel</button>
        <button class="glass-btn primary" id="submitItemBtn">Submit</button>
      </div>
    </div>
  </div>

  <!-- Detail Modal -->
  <div class="modal detail-modal" id="detailModal" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="detailTitle"></h3>
        <button class="modal-close" onclick="closeDetailModal()">√ó</button>
      </div>
      <div class="modal-body" id="detailBody"></div>
    </div>
  </div>

  <!-- ---------- ADDED: Login Modal ---------- -->
  <div class="modal auth-modal" id="loginModal" aria-hidden="true">
    <div class="modal-content">
      <div class="auth-header">
        <div class="auth-title">Login</div>
        <button class="modal-close" onclick="closeLoginModal()">√ó</button>
      </div>
      <div class="auth-body">
        <div class="form-group">
          <label class="form-label">Email</label>
          <input id="loginEmail" class="form-input" type="email" placeholder="you@example.com" required>
        </div>
        <div class="form-group">
          <label class="form-label">Password</label>
          <input id="loginPassword" class="form-input" type="password" placeholder="Your password" required>
        </div>
        <div class="error-msg" id="loginError"></div>
        <div class="small-note">Don't have an account? <a href="#" id="openSignupFromLogin">Sign up</a></div>
      </div>
      <div class="auth-footer">
        <button class="glass-btn" onclick="closeLoginModal()">Cancel</button>
        <button class="glass-btn primary" id="loginSubmitBtn">Login</button>
      </div>
    </div>
  </div>

  <!-- ---------- ADDED: Signup Modal ---------- -->
  <div class="modal auth-modal" id="signupModal" aria-hidden="true">
    <div class="modal-content">
      <div class="auth-header">
        <div class="auth-title">Sign up</div>
        <button class="modal-close" onclick="closeSignupModal()">√ó</button>
      </div>
      <div class="auth-body">
        <div class="form-group">
          <label class="form-label">Full name</label>
          <input id="signupName" class="form-input" type="text" placeholder="Your full name" required>
        </div>
        <div class="form-group">
          <label class="form-label">Email</label>
          <input id="signupEmail" class="form-input" type="email" placeholder="you@example.com" required>
        </div>
        <div class="form-group">
          <label class="form-label">Password (min 6 chars)</label>
          <input id="signupPassword" class="form-input" type="password" placeholder="Create a password" required minlength="6">
        </div>
        <div class="error-msg" id="signupError"></div>
        <div class="success-msg" id="signupSuccess"></div>
      </div>
      <div class="auth-footer">
        <button class="glass-btn" onclick="closeSignupModal()">Cancel</button>
        <button class="glass-btn primary" id="signupSubmitBtn">Create account</button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="glass-footer">
    <p>&copy; 2024 BBD Lost & Found. All rights reserved.</p>
  </footer>

  <!-- ---------- APP LOGIC ---------- -->
  <script>
    // Sample posts data (kept same as before)
    let postsData = [
      {id: 1, status: 'found', category: 'Electronics', name: 'Blue Water Bottle', description: 'Found near the library entrance. Has a sports team sticker.', location: 'Library', time: '2 hours ago', email: 'john.doe@bbd.ac.in', phone: '+91 9876543210', userName: 'John Doe', image: null, emoji: 'üíß'},
      {id: 2, status: 'lost', category: 'Accessories', name: 'Black Backpack', description: 'Lost near the cafeteria. Contains textbooks and notebooks.', location: 'Cafeteria', time: '5 hours ago', email: 'jane.smith@bbd.ac.in', phone: '+91 9876543211', userName: 'Jane Smith', image: null, emoji: 'üéí'},
      /* ... rest of your existing posts ... */
      {id: 52, status: 'lost', category: 'Accessories', name: 'Eyeglasses', description: 'Prescription glasses with black frame.', location: 'Library', time: '5 days ago', email: 'caleb.rivera@bbd.ac.in', phone: '+91 9876543261', userName: 'Caleb Rivera', image: null, emoji: 'üëì'}
    ];

    // Current filters
    let currentFilters = { search: '', status: '', category: '' };

    // Editing state (if you later integrate edit)
    let editingPostId = null;

    // Render posts
    function renderPosts() {
      const grid = document.getElementById('postsGrid');
      const filtered = postsData.filter(post => {
        const matchSearch = post.name.toLowerCase().includes(currentFilters.search.toLowerCase()) || 
                            post.description.toLowerCase().includes(currentFilters.search.toLowerCase());
        const matchStatus = !currentFilters.status || post.status === currentFilters.status;
        const matchCategory = !currentFilters.category || post.category === currentFilters.category;
        return matchSearch && matchStatus && matchCategory;
      });

      grid.innerHTML = filtered.map(post => `
        <div class="post-card glass-card" onclick="openDetailModal(${post.id})">
          <div class="post-status ${post.status}">${post.status.toUpperCase()}</div>
          <div class="post-image">
            ${post.image ? `<img src="${post.image}" alt="${post.name}">` : `<div class="post-image-placeholder">${post.emoji}</div>`}
          </div>
          <div class="post-content">
            <span class="post-category">${post.category}</span>
            <h4 class="post-title">${post.name}</h4>
            <p class="post-description">${post.description}</p>
            <div class="post-meta">
              <div class="meta-item">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <span>${post.time}</span>
              </div>
              <div class="meta-item">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                  <circle cx="12" cy="10" r="3"></circle>
                </svg>
                <span>${post.location}</span>
              </div>
            </div>
            <div class="post-actions">
              <button class="glass-btn small" onclick="event.stopPropagation(); editPost(${post.id})">‚úèÔ∏è Edit</button>
              <button class="glass-btn small primary" onclick="event.stopPropagation(); openDetailModal(${post.id})">View Details</button>
              <button class="glass-btn small success" onclick="event.stopPropagation(); contactPerson('${post.email}')">Contact</button>
            </div>
          </div>
        </div>
      `).join('');
    }

    // Filter listeners and image preview
    document.addEventListener('DOMContentLoaded', () => {
      renderPosts();

      document.getElementById('searchInput').addEventListener('input', (e) => {
        currentFilters.search = e.target.value;
        renderPosts();
      });

      document.getElementById('statusFilter').addEventListener('change', (e) => {
        currentFilters.status = e.target.value;
        renderPosts();
      });

      document.querySelectorAll('.category-pill').forEach(pill => {
        pill.addEventListener('click', (e) => {
          document.querySelectorAll('.category-pill').forEach(p => p.classList.remove('active'));
          e.target.classList.add('active');
          currentFilters.category = e.target.dataset.category;
          renderPosts();
        });
      });

      document.getElementById('itemImage').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(ev) {
            document.getElementById('previewImg').src = ev.target.result;
            document.getElementById('imagePreview').style.display = 'block';
          };
          reader.readAsDataURL(file);
        }
      });

      // Nav buttons
      document.getElementById('loginBtn').addEventListener('click', openLoginModal);
      document.getElementById('signupBtn').addEventListener('click', openSignupModal);
      document.getElementById('addItemBtn').addEventListener('click', () => {
        // Check auth status (set by firebase onAuthStateChanged)
        if (!window.currentUser) {
          openLoginModal();
        } else {
          // Pre-fill user info (name & email)
          const user = window.currentUser;
          document.getElementById('userName').value = user.displayName || '';
          document.getElementById('userEmail').value = user.email || '';
          openAddModal();
        }
      });

      // Signup/login modal quick link
      document.getElementById('openSignupFromLogin').addEventListener('click', (e) => {
        e.preventDefault();
        closeLoginModal();
        openSignupModal();
      });

      // Submit handlers
      document.getElementById('signupSubmitBtn').addEventListener('click', handleSignup);
      document.getElementById('loginSubmitBtn').addEventListener('click', handleLogin);
      document.getElementById('submitItemBtn').addEventListener('click', submitItem);

      // animation observer (kept original)
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'translateY(0)';
          }
        });
      }, { threshold: 0.1 });
      setTimeout(() => {
        document.querySelectorAll('.glass-card').forEach(card => {
          card.style.opacity = '0';
          card.style.transform = 'translateY(20px)';
          card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
          observer.observe(card);
        });
      }, 100);
    });

    // Modal helpers
    function openAddModal() { document.getElementById('addModal').classList.add('active'); }
    function closeAddModal() {
      document.getElementById('addModal').classList.remove('active');
      document.getElementById('addItemForm').reset();
      document.getElementById('imagePreview').style.display = 'none';
      editingPostId = null;
    }
    function openDetailModal(id) {
      const post = postsData.find(p => p.id === id);
      if (!post) return;
      document.getElementById('detailTitle').textContent = post.name;
      document.getElementById('detailBody').innerHTML = `
        ${post.image ? `<img src="${post.image}" class="detail-image" alt="${post.name}">` :
        `<div class="post-image" style="margin-bottom:24px;"><div class="post-image-placeholder">${post.emoji}</div></div>`}
        <div class="detail-info">
          <div class="info-item"><div class="info-label">Status</div><div class="info-value">${post.status.toUpperCase()}</div></div>
          <div class="info-item"><div class="info-label">Category</div><div class="info-value">${post.category}</div></div>
          <div class="info-item"><div class="info-label">Location</div><div class="info-value">${post.location}</div></div>
          <div class="info-item"><div class="info-label">Posted</div><div class="info-value">${post.time}</div></div>
        </div>
        <div style="margin-bottom:24px;">
          <h4 style="margin-bottom:12px; font-size:18px;">Description</h4>
          <p style="color: var(--text-secondary); line-height:1.6;">${post.description}</p>
        </div>
        <div class="contact-section">
          <h4 style="margin-bottom:16px; font-size:18px;">Contact Information</h4>
          <div style="display:grid; gap:12px;">
            <div style="display:flex; align-items:center; gap:12px;"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg><span><strong>Name:</strong> ${post.userName}</span></div>
            <div style="display:flex; align-items:center; gap:12px;"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg><span><strong>Email:</strong> <a href="mailto:${post.email}" style="color: var(--primary-color);">${post.email}</a></span></div>
            <div style="display:flex; align-items:center; gap:12px;"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg><span><strong>Phone:</strong> <a href="tel:${post.phone}" style="color: var(--primary-color);">${post.phone}</a></span></div>
          </div>
          <div style="margin-top:20px; display:flex; gap:12px;">
            <button class="glass-btn primary" onclick="contactPerson('${post.email}')">Send Email</button>
            <button class="glass-btn success" onclick="window.location.href='tel:${post.phone}'">Call Now</button>
          </div>
        </div>
      `;
      document.getElementById('detailModal').classList.add('active');
    }
    function closeDetailModal() { document.getElementById('detailModal').classList.remove('active'); }
    function contactPerson(email) { window.location.href = `mailto:${email}`; }
    window.addEventListener('click', function(e) { if (e.target.classList.contains('modal')) e.target.classList.remove('active'); });

    // Edit Post (simple prefill)
    function editPost(id) {
      const post = postsData.find(p => p.id === id);
      if (!post) return;
      editingPostId = id;
      document.getElementById('itemStatus').value = post.status;
      document.getElementById('itemCategory').value = post.category;
      document.getElementById('itemName').value = post.name;
      document.getElementById('itemDescription').value = post.description;
      document.getElementById('itemLocation').value = post.location;
      document.getElementById('userName').value = post.userName;
      document.getElementById('userEmail').value = post.email;
      document.getElementById('userPhone').value = post.phone;
      if (post.image) { document.getElementById('previewImg').src = post.image; document.getElementById('imagePreview').style.display = 'block'; }
      else document.getElementById('imagePreview').style.display = 'none';
      openAddModal();
    }

    function getCategoryEmoji(category) {
      const emojis = { 'Electronics':'üì±','Books':'üìö','Accessories':'üéí','Clothing':'üëï','Documents':'üìÑ','Others':'üì¶' };
      return emojis[category] || 'üì¶';
    }

    function submitItem() {
      // require auth
      if (!window.currentUser) {
        openLoginModal();
        return;
      }

      const form = document.getElementById('addItemForm');
      if (!form.checkValidity()) { form.reportValidity(); return; }

      const postObj = {
        status: document.getElementById('itemStatus').value,
        category: document.getElementById('itemCategory').value,
        name: document.getElementById('itemName').value,
        description: document.getElementById('itemDescription').value,
        location: document.getElementById('itemLocation').value,
        userName: document.getElementById('userName').value,
        email: document.getElementById('userEmail').value,
        phone: document.getElementById('userPhone').value,
        time: editingPostId ? 'Updated now' : 'Just now',
        emoji: getCategoryEmoji(document.getElementById('itemCategory').value),
        image: document.getElementById('previewImg').src || null
      };

      if (editingPostId) {
        const index = postsData.findIndex(p => p.id === editingPostId);
        postsData[index] = { ...postsData[index], ...postObj };
        editingPostId = null;
        alert('Post updated successfully!');
      } else {
        postsData.unshift({ id: postsData.length + 1, ...postObj });
        alert('Item posted successfully!');
      }

      renderPosts();
      closeAddModal();
    }
  </script>

  <!-- ---------- FIREBASE AUTH (CDN module) ---------- -->
  <script type="module">
    // Use the config you provided earlier
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
    import {
      getAuth,
      createUserWithEmailAndPassword,
      signInWithEmailAndPassword,
      signOut,
      onAuthStateChanged,
      updateProfile
    } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAkXGv71dqUPp_5g2uCPBoRZrBCgpZ8a5c",
      authDomain: "bbd-lost-and-found-66898.firebaseapp.com",
      projectId: "bbd-lost-and-found-66898",
      storageBucket: "bbd-lost-and-found-66898.firebasestorage.app",
      messagingSenderId: "13536453880",
      appId: "1:13536453880:web:5328c59e03f6d1bc30470d"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // Expose currentUser globally for the app logic to check
    window.currentUser = null;

    // UI elements
    const loginModal = document.getElementById('loginModal');
    const signupModal = document.getElementById('signupModal');
    const loginError = document.getElementById('loginError');
    const signupError = document.getElementById('signupError');
    const signupSuccess = document.getElementById('signupSuccess');
    const navRight = document.getElementById('navRight');

    // Open/close helpers
    window.openLoginModal = () => {
      loginError.style.display = 'none';
      loginError.textContent = '';
      loginModal.classList.add('active');
    };
    window.closeLoginModal = () => loginModal.classList.remove('active');

    window.openSignupModal = () => {
      signupError.style.display = 'none';
      signupError.textContent = '';
      signupSuccess.style.display = 'none';
      signupModal.classList.add('active');
    };
    window.closeSignupModal = () => signupModal.classList.remove('active');

    // Signup handler
    async function handleSignup() {
      signupError.style.display = 'none';
      signupSuccess.style.display = 'none';
      const name = document.getElementById('signupName').value.trim();
      const email = document.getElementById('signupEmail').value.trim();
      const password = document.getElementById('signupPassword').value;

      if (!name || !email || password.length < 6) {
        signupError.style.display = 'block';
        signupError.textContent = 'Please enter valid name, email and a password of at least 6 characters.';
        return;
      }

      try {
        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
        // update displayName
        if (userCredential.user) {
          await updateProfile(userCredential.user, { displayName: name });
        }
        signupSuccess.style.display = 'block';
        signupSuccess.textContent = 'Account created. You are now logged in.';
        closeSignupModal();
      } catch (err) {
        signupError.style.display = 'block';
        signupError.textContent = err.message || 'Signup failed';
      }
    }

    // Login handler
    async function handleLogin() {
      loginError.style.display = 'none';
      const email = document.getElementById('loginEmail').value.trim();
      const password = document.getElementById('loginPassword').value;
      if (!email || !password) {
        loginError.style.display = 'block';
        loginError.textContent = 'Please enter email and password.';
        return;
      }
      try {
        await signInWithEmailAndPassword(auth, email, password);
        closeLoginModal();
      } catch (err) {
        loginError.style.display = 'block';
        loginError.textContent = err.message || 'Login failed';
      }
    }

    // Logout
    async function handleLogout() {
      try {
        await signOut(auth);
        // UI will update in onAuthStateChanged
      } catch (err) {
        console.error('Logout error', err);
      }
    }

    // Replace nav buttons with user info when logged in
    function renderAuthUI(user) {
      // Clear existing auth controls
      // We'll re-add either login/signup or user+logout
      // Remove any existing user button nodes
      const existingUserNode = document.getElementById('authUserBtn');
      const existingLogoutNode = document.getElementById('authLogoutBtn');
      if (existingUserNode) existingUserNode.remove();
      if (existingLogoutNode) existingLogoutNode.remove();

      // If logged in, show displayName and logout
      if (user) {
        const userBtn = document.createElement('button');
        userBtn.id = 'authUserBtn';
        userBtn.className = 'glass-btn';
        userBtn.textContent = user.displayName || (user.email ? user.email.split('@')[0] : 'User');
        userBtn.addEventListener('click', () => {
          // optional: open profile or contributions
          window.location.href = 'contributions.html';
        });

        const logoutBtn = document.createElement('button');
        logoutBtn.id = 'authLogoutBtn';
        logoutBtn.className = 'glass-btn';
        logoutBtn.textContent = 'Logout';
        logoutBtn.addEventListener('click', handleLogout);

        // hide original login/signup buttons
        const loginBtn = document.getElementById('loginBtn');
        const signupBtn = document.getElementById('signupBtn');
        if (loginBtn) loginBtn.style.display = 'none';
        if (signupBtn) signupBtn.style.display = 'none';

        navRight.appendChild(userBtn);
        navRight.appendChild(logoutBtn);

      } else {
        // show login/signup and remove user nodes
        const loginBtn = document.getElementById('loginBtn');
        const signupBtn = document.getElementById('signupBtn');
        if (loginBtn) loginBtn.style.display = 'inline-flex';
        if (signupBtn) signupBtn.style.display = 'inline-flex';
        const userNode = document.getElementById('authUserBtn');
        const logoutNode = document.getElementById('authLogoutBtn');
        if (userNode) userNode.remove();
        if (logoutNode) logoutNode.remove();
      }
    }

    // Listen for auth state changes
    onAuthStateChanged(auth, (user) => {
      if (user) {
        window.currentUser = user;
        // persist some minimal info locally (optional)
        localStorage.setItem('bbd_user', JSON.stringify({ uid: user.uid, displayName: user.displayName, email: user.email }));
      } else {
        window.currentUser = null;
        localStorage.removeItem('bbd_user');
      }
      renderAuthUI(user);
    });

    // wire to global functions so the rest of the app can call
    window.handleSignup = handleSignup;
    window.handleLogin = handleLogin;
    window.handleLogout = handleLogout;

    // quick exposure for debugging
    window.auth = auth;
  </script>
</body>
</html>
